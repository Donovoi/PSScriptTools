examples:
- name: EXAMPLE 1
  preCode: ''
  code: PS C:\> get-process | sort-object WS -Descending | Select-object -first 20 ID,Name,WS,VM,PM,Handles,StartTime | Convertto-WPFGrid -Refresh -timeout 20 -Title "Top Processes"
  postCode: Get the top 20 processes based on the value of the WorkingSet property and display selected properties in the WPF Grid. The contents will automatically refresh every 20 seconds. You will need to manually close the form.
- name: EXAMPLE 2
  preCode: ''
  code: >-
    PS C:\> $vmhost = "CHI-HVR2"

    PS C:\> Get-VM -computername $VMHost | Select Name,State,Uptime,

    @{Name="AssignedMB";Expression={$_.MemoryAssigned/1mb -as [int]}},

    @{Name="DemandMB";Expression={$_.MemoryDemand/1mb -as [int]}} |

    ConvertTo-WPFGrid -title "VM Report $VMHost" -timeout 30 -refresh -uselocalvariable VMHost
  postCode: Get Hyper-V virtual machine information and refresh every 30 seconds. Because the command is using a locally defined variable it is also being used in the form. Note that this would be written as one long pipelined expression. It is formatted here for the sake of the help documentation.
- name: EXAMPLE 3
  preCode: ''
  code: PS C:\> Get-VMData -host CHI-HVR2 | ConvertTo-WPFGrid -title "VM Data" -refresh -timeout 60 -useprofile
  postCode: This example uses a hypothetical command that might be defined in a PowerShell profile script. ConvertTo-WPFGrid will load the profile scripts so that the data can be updated every 60 seconds.
- name: EXAMPLE 4
  preCode: ''
  code: PS C:\> (get-processdata -Computername $computers).where({$_.workingset -ge 100mb}) | ConvertTo-WPFGrid -Title "Process Report" -UseLocalVariable computers -InitializationScript {. C:\scripts\Get-ProcessData.ps1} -Refresh -Timeout 30
  postCode: This command runs a function that is defined in a script file. In order for the form to refresh, it must also dot source the script which is happening with the InitializationScript parameter. The example is also loading the local $computers variable so that it too is available upon refresh.
inputs:
- type: '[PSObject]'
  description: ''
links:
- href: https://github.com/jdhitsolutions/PSScriptTools/blob/master/docs/ConvertTo-WPFGrid.md
  text: 'Online Version:'
- href: ''
  text: Out-GridView
- href: ''
  text: ConvertTo-HTML
- href: ./ConvertTo-Markdown.md
  text: ConvertTo-Markdown
module:
  name: PSScriptTools
name: ConvertTo-WPFGrid
notes: 'Learn more about PowerShell: http://jdhitsolutions.com/blog/essential-powershell-resources/'
optionalParameters:
- name: InputObject
  aliases: []
  defaultValue: None
  description: Typically the results of a PowerShell command or expression. You should select the specific properties you wish to display.
  parameterValueGroup: []
  pipelineInput: True (ByValue)
  position: 1
  type: PSObject
- name: Title
  aliases: []
  defaultValue: ConvertTo-WPFGrid
  description: Specify a title for your form.
  parameterValueGroup: []
  pipelineInput: False
  position: 2
  type: String
- name: Timeout
  aliases: []
  defaultValue: 0
  description: By default the grid will remain displayed until you manually close it. But you can specify a timeout interval in seconds. The minimum accepted value is 5 seconds. If you use this parameter with -Refresh, then the datagrid will be refreshed with results of the PowerShell expression you piped to ConvertTo-WPFGrid.
  parameterValueGroup: []
  pipelineInput: False
  position: 3
  type: Int32
- name: Refresh
  aliases: []
  defaultValue: None
  description: >-
    If you specify this parameter and a Timeout value, this command will refresh the datagrid with the PowerShell expression piped into ConvertTo-WPFGrid. You should use a value that is longer than the time it takes to complete the command that generates your data.

    This parameter will only work if you are using Convertto-WPFGrid at the end of a pipelined expression. See examples.
  parameterValueGroup: []
  pipelineInput: False
  position: Named
  type: SwitchParameter
- name: UseProfile
  aliases:
  - profile
  defaultValue: None
  description: Load your PowerShell profiles into the background runspace.
  parameterValueGroup: []
  pipelineInput: False
  position: Named
  type: SwitchParameter
- name: Scriptblock
  aliases: []
  defaultValue: None
  description: Enter a scriptblock that will generate data to be populated in the form
  parameterValueGroup: []
  pipelineInput: False
  position: Named
  type: ScriptBlock
- name: UseLocalVariable
  aliases:
  - var
  defaultValue: None
  description: Load locally defined variables into the background runspace
  parameterValueGroup: []
  pipelineInput: False
  position: Named
  type: String[]
- name: InitializationScript
  aliases: []
  defaultValue: None
  description: Run this scriptblock to initialize the background runspace. You might need to dot source a script file or load a non-standard module.
  parameterValueGroup: []
  pipelineInput: False
  position: Named
  type: ScriptBlock
- name: Gridlines
  aliases: []
  defaultValue: None
  description: Control how grid lines are displayed in the form. You may not want to have any or perhaps only vertical or horizontal lines.
  parameterValueGroup: []
  pipelineInput: False
  position: Named
  type: String
outputs:
- type: None
  description: ''
requiredParameters: []
remarks: >-
  This command is an alternative to Out-Gridview. It works much the same way. Run a PowerShell command and pipe it to this command. The output will be displayed in an auto-sized data grid. You can click on column headings to sort. You can resize columns and you can re-order columns. You will want to be selective about which properties you pipe through to this command. See examples.

  You can specify a timeout value which will automatically close the form. If you specify a timeout and the Refresh parameter, then the contents of the datagrid will automatically refreshed using the timeout value as an integer. This will only work when you pipe a PowerShell expression to ConvertTo-WPFGrid as one command. This will fail if you break the command in the PowerShell ISE or use a nested prompt. Beginning with v2.4.0 the form now has a Refresh button which will automatically refresh the datagrid. You should set a refresh interval that is greater than the time it takes to complete the command.

  Because the grid is running in a new background runspace, it does not automatically inherit anything from your current session. However, you can use the -UserProfile parameter which will load your user profile scripts into the runspace. You can specify a list of locally defined variables to be used in the form. Use the variable name without the $. Finally, you can also use the -InitializationScript parameter and specify a scriptblock of PowerShell code to initialize the runspace. This is helpful when you need to dot source external scripts or import modules not in your module path.

  This command runs the WPF grid in a new runspace so your PowerShell prompt will not be blocked. However, after closing the form you may be left with the runspace. You can use Remove-Runspace to clean up or wait until you restart PowerShell.
summary: Send command output to an interactive WPF-based grid.
syntaxes:
- parameterValueGroup: Input
  parameters:
  - InputObject
  - Title
  - Timeout
  - Refresh
  - UseProfile
  - UseLocalVariable
  - InitializationScript
  - Gridlines
- parameterValueGroup: scriptblock
  parameters:
  - Title
  - Timeout
  - Refresh
  - UseProfile
  - Scriptblock
  - UseLocalVariable
  - InitializationScript
  - Gridlines
